#![allow(non_camel_case_types, non_snake_case, non_upper_case_globals)]

/// Implement one step of mersenne twister
#[inline]
fn twist_one(state: u32, i: u32) -> u32 {
    i.wrapping_add((state ^ state >> 30).wrapping_mul(0x6c078965))
        .wrapping_add(1)
}

/// Get `twister[count]` after `init(seed)`
#[inline]
fn twist(state: u32, count: u32) -> u32 {
    let mut state = state;
    for i in 0..count {
        state = twist_one(state, i);
    }
    state
}

fn prng_one(mut seed: u32) -> f32 {
    // seed 0 probably has some bad properties, lol
    if seed == 0 {
        seed = 0x12345678;
    }

    // the game uses mersenne twister to implement this PRNG
    // its REALLY redundant, they just seed it and call 2 times
    // and we can actually optimize out the "twister" array used

    let state_0 = seed;
    let state_1 = twist(seed, 1);
    let state_397 = twist(seed, 397);

    let v = (state_0 & 0x80000000) + (state_1 & 0x7fffffff);

    let mut state = state_397 ^ (v >> 1);

    if (v % 2) != 0 {
        state ^= 0x9908b0df;
    }

    state ^= state >> 11;
    state ^= (state << 7) & 0x9d2c5680;
    state ^= (state << 15) & 0xefc60000;
    state ^= state >> 18;

    // I __think__ some of those conversions are not required, but to get the same results it's easier to just do them
    let value = (state as f32 as f64 * 2.328306e-10f64) as f32;
    ((value + value) as f64 + -1.0f64) as f32
}

pub fn prng(time_frac: f32, time_int: i32, seed: i32) -> f32 {
    let from: f32;
    let to: f32;
    if time_int == 0 {
        // don't do anything crazy at the start
        to = 0.0;
        from = 0.0;
    } else {
        // combine current iteration with seed to get seeds for next iteration
        let seed = (time_int + seed) as u32;

        // generate two random numbers
        from = prng_one(seed);
        to = prng_one(seed.wrapping_add(1));
    }
    // interpolate between the two random numbers
    from + time_frac * (to - from)
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_prng() {
        assert_eq!(prng(0.0, 0, 0), 0.0);
        assert_eq!(prng(0.0, 1, 0), -0.1659562);
        assert_eq!(prng(0.1, 1, 0), -0.16216162);
        assert_eq!(prng(0.5, 1, 0), -0.1469833);
        assert_eq!(prng(0.99, 1, 0), -0.12838985);
        assert_eq!(prng(0.0, 2, 0), -0.12801039);
        assert_eq!(prng(0.25, 2, 0), -0.070608914);
        assert_eq!(prng(0.5, 2, 0), -0.013207436);
        assert_eq!(prng(0.75, 2, 0), 0.044194043);
        assert_eq!(prng(0.99, 2, 0), 0.09929946);
        assert_eq!(prng(0.0, 3, 0), 0.10159552);

        assert_eq!(prng(0.0, 1, 1), -0.12801039);
        assert_eq!(prng(0.0, 2, 1), 0.10159552);
        assert_eq!(prng(0.0, 3, 1), 0.93405926);
        assert_eq!(prng(0.0, 4, 1), -0.5560137);
    }

    #[test]
    fn test_prng_one() {
        let values = [
            0.55150044,
            -0.1659562,
            -0.12801039,
            0.10159552,
            0.93405926,
            -0.5560137,
            0.78572,
            -0.84738344,
            0.7468585,
            -0.9792517,
            0.54264104,
            -0.6394607,
            -0.69167435,
            0.55540454,
            0.02788639,
            0.69763505,
            -0.5534179,
            -0.4106701,
            0.30074823,
            -0.80493283,
            0.1762613,
            -0.9025503,
            -0.583079,
            0.03459549,
            0.9200343,
            0.74024796,
            -0.38413024,
            -0.14855736,
            0.45802724,
            0.72751963,
            0.2882868,
            -0.42789245,
            0.7177782,
            -0.5029799,
            -0.92287666,
            -0.08389026,
            0.4570142,
            0.8889929,
            -0.23045391,
            0.09377813,
            -0.1846261,
            -0.49815285,
            -0.25091988,
            -0.7698909,
            0.66968393,
            0.9780227,
            0.5676645,
            -0.7730231,
            -0.96501946,
            -0.39807123,
            -0.010796905,
            0.3514626,
            0.6462203,
            0.69332445,
            -0.15963423,
            -0.81378347,
            0.9683833,
            -0.82530075,
            -0.26978898,
            0.8480699,
            -0.39825344,
            0.64893854,
            -0.9324906,
            0.107881784,
            -0.24180305,
            -0.56271,
            -0.6914249,
            0.09170258,
            -0.4812572,
            -0.40750182,
            0.8549607,
            -0.6288495,
            -0.78652364,
            0.28537965,
            -0.5955955,
            0.1378802,
            -0.37834054,
            0.83821774,
            -0.9036376,
            0.0013359785,
            0.04383123,
            -0.28916186,
            -0.44954878,
            -0.48591524,
            -0.90791804,
            0.24074733,
            -0.59478617,
            0.31252813,
            0.29510188,
            -0.00061154366,
            -0.69389164,
            -0.5979929,
            0.7717606,
            0.21270847,
            0.43877137,
            -0.5423931,
            -0.5706263,
            0.67388785,
            0.46453428,
            0.34455693,
            0.086809635,
            0.03279698,
            0.19536293,
            -0.13577777,
            -0.7041588,
            -0.8325202,
            -0.9828704,
            -0.6745901,
            -0.5327778,
            0.22292078,
            -0.76788235,
            0.22434008,
            -0.24988586,
            0.7039707,
            -0.6967361,
            -0.60781544,
            -0.24966288,
            -0.09717792,
            0.8853028,
            0.6956872,
            0.3559109,
            -0.7773384,
            -0.6860164,
            0.39293814,
            -0.7878702,
            0.013451815,
            -0.7896558,
            0.04766643,
            0.73327374,
            0.14106297,
            -0.71673954,
            0.30030692,
            0.5618075,
            -0.16098297,
            0.6228069,
            0.3226577,
            -0.6935682,
            0.8877001,
            0.4986843,
            -0.018075407,
            0.49581075,
            0.83477056,
            0.8041227,
            0.47550964,
            -0.81331193,
            -0.4339162,
            -0.0037813187,
            -0.26660895,
            0.15081143,
            0.7626147,
            0.8171675,
            0.53958845,
            0.8974552,
            -0.70460033,
            0.015447259,
            0.30465245,
            -0.37276113,
            0.5948038,
            -0.8074613,
            0.5776925,
            0.66678524,
            0.8813468,
            -0.35799998,
            0.37792742,
            -0.28603464,
            0.65244544,
            -0.40452206,
            0.7967577,
            0.19559729,
            0.3391813,
            -0.89470917,
            0.31549215,
            -0.7011964,
            -0.8134851,
            -0.079922736,
            0.6041753,
            -0.28512454,
            0.0056619644,
            0.04919231,
            0.9009098,
            0.12544596,
            0.048045993,
            0.753134,
            0.64670634,
            -0.86308795,
            -0.738893,
            0.085397124,
            -0.15991819,
            0.023954988,
            -0.15458173,
            0.49025536,
            0.08321929,
            0.5145991,
            -0.19602281,
            0.9353967,
            0.774655,
            0.3790183,
            0.73581314,
            0.21960294,
            0.3095832,
            0.89526415,
            -0.77219087,
            -0.5515877,
            0.6957997,
            0.8611127,
            0.920521,
            -0.14535171,
            0.00592947,
            -0.77818716,
            0.6865673,
            -0.80015165,
            0.5627359,
            -0.53419685,
            -0.563147,
            -0.90351194,
            -0.6921569,
            -0.9288219,
            -0.7926767,
            -0.33149272,
            -0.9730132,
            -0.2796957,
            0.0931412,
            0.05205667,
            0.63077056,
            -0.037130117,
            -0.4156688,
            0.78991413,
            -0.74505717,
            -0.15237856,
            -0.80595005,
            0.26199973,
            0.5629878,
            -0.3458075,
            -0.7010618,
            -0.93806535,
            0.8611759,
            -0.84426844,
            0.97561693,
            -0.869323,
            -0.38033766,
            -0.41298705,
            0.22989464,
            0.36937273,
            -0.5847293,
            -0.4186448,
            0.81370735,
            -0.040701628,
            -0.26763946,
            0.383973,
            0.033872962,
            -0.57044137,
            0.27522218,
            -0.98917335,
            -0.47588038,
            0.024123311,
            -0.07212716,
            -0.9084324,
            0.85965264,
            -0.83074564,
            0.38043952,
            -0.8067765,
            0.6018715,
            -0.21569419,
            0.14656734,
            0.55293167,
            0.043845415,
            -0.8406719,
            -0.64673936,
            -0.7020434,
            -0.48336357,
            0.38824964,
            0.2777692,
            -0.50455904,
            -0.8545429,
            -0.4350093,
            -0.1253562,
            0.92755723,
            -0.03098917,
            -0.60835457,
            0.17157483,
            -0.7334877,
            -0.09112084,
            -0.26314753,
            0.19483006,
            0.69175494,
            -0.4951957,
            -0.70995224,
            -0.7110296,
            0.10653913,
            0.45426285,
            -0.45317495,
            -0.80336094,
            -0.4974094,
            0.6314753,
            0.3360505,
            0.24430645,
            -0.39065784,
            0.89919114,
            0.37539816,
            -0.4008901,
            -0.097755015,
            -0.3254401,
            0.27256215,
            0.5002966,
            -0.16653496,
            -0.6896671,
            -0.41983104,
            -0.35873812,
            0.5689256,
            0.57590365,
            0.63703835,
            -0.09092164,
            -0.5665463,
            -0.6689208,
            0.8337468,
            0.23335803,
            0.66114044,
            -0.3912995,
            0.17345619,
            0.99688864,
            0.42870772,
            0.7718955,
            -0.17485142,
            0.9467766,
            -0.8793666,
            0.85546887,
            0.039043546,
            -0.104083,
            -0.51480776,
            0.14764714,
            -0.008437216,
            0.8933433,
            0.8363496,
            0.086581945,
            -0.52372694,
            0.5210326,
            -0.11920214,
            0.5998132,
            -0.76493,
            0.27549434,
            -0.4371603,
            -0.4696663,
            -0.8699312,
            -0.84988797,
            -0.37222844,
            -0.25814664,
            0.18723881,
            -0.46707588,
            -0.4542845,
            -0.57190084,
            -0.13573778,
            -0.9774685,
            0.74586904,
            -0.12764013,
            0.46295333,
            -0.53754115,
            -0.026066124,
            0.4465288,
            0.42722476,
            0.7578908,
            -0.0044438243,
            -0.7796022,
            -0.96809787,
            -0.78918517,
            -0.1495279,
            0.8829111,
            -0.790315,
            -0.8185747,
            -0.16968155,
            0.29999852,
            -0.26841068,
            0.34151483,
            -0.54029274,
            0.3886634,
            -0.72876215,
            -0.59364927,
            -0.19165647,
            -0.7630318,
            0.1886481,
            0.6080799,
            -0.59011304,
            0.17060423,
            0.5079582,
            -0.12016797,
            0.5711955,
            -0.8339503,
            0.47640574,
            0.18396151,
            -0.32992333,
            -0.41757327,
            0.794503,
            -0.8828875,
            -0.2699293,
            -0.60114884,
            0.018699765,
            -0.02816248,
            -0.383848,
            -0.575359,
            0.4826777,
            -0.24988395,
            0.33745754,
            0.4584043,
            -0.89828473,
            -0.63525295,
            0.33764994,
            0.40316653,
            0.8364284,
            0.7047434,
            -0.012711704,
            -0.5775243,
            0.7748029,
            0.6907226,
            0.8899342,
            0.31356883,
            -0.9425343,
            -0.8740319,
            -0.24478114,
            -0.9620444,
            -0.35895026,
            -0.41966206,
            -0.3687083,
            0.36556375,
            -0.5054846,
            -0.32572222,
            0.632517,
            0.51610875,
            0.74346423,
            0.90812135,
            0.63684785,
            -0.2737484,
            -0.6881304,
            0.849139,
            0.80732083,
            -0.043682694,
            -0.2930138,
            0.866423,
            -0.52584946,
            0.07641935,
            -0.6687779,
            0.17971444,
            -0.6562828,
            0.94227767,
            -0.21064776,
            0.40212953,
            0.6787218,
            0.28652263,
            0.53281975,
            -0.37289995,
            0.15311217,
            0.11726153,
            0.56083345,
            0.54597664,
            0.77285707,
            0.80002177,
            0.33740294,
            -0.17553312,
            -0.50248826,
            -0.636186,
            0.6119331,
            -0.24735403,
            0.75280666,
            -0.30067873,
            -0.07393342,
            0.6176027,
            0.41666448,
            0.73171103,
            -0.15957618,
            0.5057516,
            -0.7912591,
            0.38230658,
            -0.9596515,
            0.1726383,
            0.28468156,
            -0.9064647,
            -0.36771405,
            -0.9823116,
            0.37301028,
            -0.57493347,
            0.85564566,
            -0.9421772,
            0.61071646,
            -0.9848925,
            0.7321665,
            0.30760503,
            0.046785474,
            0.7045058,
            0.10956788,
            -0.29228902,
            -0.06942189,
            0.9559872,
            0.21123636,
            -0.28076285,
            -0.094815195,
            0.84858024,
            -0.85133827,
            -0.42387372,
            -0.8131415,
            0.8368391,
            -0.5818927,
            0.90762115,
            0.38735878,
            -0.58495003,
            -0.82190925,
            -0.9583621,
            0.62248075,
            0.7012359,
            0.6957756,
            -0.9695999,
            -0.34911042,
            0.5117458,
            0.11967254,
            -0.46127516,
            -0.7854083,
            -0.80205506,
            -0.044695854,
            -0.010876715,
            0.62313175,
            -0.1905443,
            -0.9693765,
            0.23695064,
            -0.11616218,
            0.41243243,
            -0.48764247,
            -0.93239367,
            0.23737359,
            0.5005641,
            -0.84630096,
            0.9854646,
            -0.4328425,
            -0.54894745,
            0.6189344,
            0.37961566,
            -0.18225133,
            0.77308977,
            -0.6537515,
            -0.27568054,
            -0.98408103,
            -0.2049824,
            0.56482613,
            -0.777236,
            0.43376303,
            0.04139304,
            -0.8357136,
            0.9945493,
            -0.17367858,
            -0.8273857,
            -0.8181776,
            0.7274662,
            -0.102529764,
            -0.90325993,
            -0.2650727,
            0.28012788,
            -0.8813153,
            0.78562737,
            -0.12499094,
            0.435668,
            0.6602576,
            0.819139,
            -0.7569454,
            0.11554515,
            0.6599467,
            0.9103707,
            -0.92870164,
            0.6141809,
            -0.39540094,
            0.40662372,
            0.2849214,
            -0.39043683,
            -0.38477707,
            0.7522265,
            -0.095819354,
            -0.6622489,
            0.02327013,
            -0.060920656,
            0.11511266,
            0.29314637,
            0.2675209,
            0.41992867,
            0.75762856,
            -0.16835189,
            0.52776027,
            -0.7656018,
            0.7011007,
            -0.74244577,
            -0.29434842,
            -0.42424554,
            -0.6309489,
            -0.09031314,
            -0.55474305,
            -0.8120522,
            0.63680744,
            0.12721479,
            -0.74441534,
            -0.7641978,
            -0.55196536,
            0.04078746,
            -0.69842553,
            0.4171728,
            0.59683657,
            0.40384614,
            -0.9352655,
            -0.72278595,
            -0.05791968,
            -0.87099665,
            -0.4160102,
            -0.26868016,
            -0.52323365,
            0.8482878,
            0.42053807,
            0.4818685,
            -0.32266313,
            -0.38738286,
            -0.7130568,
            0.5759908,
            0.68289244,
            0.90572286,
            0.54236794,
            0.50152004,
            -0.9103539,
            -0.588279,
            0.61296153,
            -0.41698474,
            0.32131302,
            0.40746117,
            -0.7894791,
            -0.47495484,
            -0.9726052,
            -0.5746354,
            -0.8480119,
            0.8978822,
            -0.892797,
            0.2498815,
            0.6631048,
            -0.59110224,
            0.7716434,
            0.7214743,
            -0.108581185,
            -0.09910315,
            -0.11770153,
            -0.17083222,
            -0.019064307,
            -0.65343934,
            0.07222307,
            0.112692595,
            0.11146581,
            0.6218749,
            0.939152,
            -0.14748287,
            -0.20107871,
            -0.88377845,
            0.7598773,
            -0.35130596,
            -0.15541464,
            -0.015910983,
            -0.20406222,
            -0.5998274,
            -0.38119465,
            -0.23950791,
            0.31295633,
            0.12405741,
            0.39032567,
            -0.35542953,
            -0.9292685,
            0.011394739,
            -0.3628201,
            0.11808288,
            0.40087402,
            -0.026779234,
            0.46552718,
            0.18679285,
            -0.88635457,
            0.48538458,
            0.6598587,
            -0.62306815,
            -0.43190557,
            0.0293895,
            0.99395895,
            -0.48896456,
            0.04378152,
            0.9479101,
            -0.066304386,
            -0.7458596,
            -0.17043978,
            -0.5248295,
            0.4773035,
            0.1625359,
            -0.3541078,
            -0.78441316,
            0.3712392,
            -0.4446081,
            0.2275784,
            -0.90831983,
            -0.9212456,
            0.7271254,
            0.8211174,
            0.45921028,
            0.58195806,
            -0.6040858,
            -0.83197683,
            -0.8349051,
            -0.6869073,
            -0.75971156,
            -0.6904507,
            0.87351394,
            -0.44371593,
            0.24658358,
            -0.061102152,
            -0.57559556,
            -0.96969885,
            0.49782038,
            0.7065244,
            0.114712715,
            0.33739448,
            0.9622898,
            0.03412831,
            -0.21190494,
            -0.30914557,
            0.30364788,
            -0.7212105,
            0.3707862,
            0.21554291,
            -0.8536214,
            -0.7291453,
            -0.55421245,
            0.774315,
            -0.00909543,
            0.5621617,
            -0.926295,
            -0.9749652,
            -0.9321179,
            -0.39300156,
            -0.16340196,
            0.82786953,
            0.6035749,
            0.58097076,
            0.35555136,
            -0.18232226,
            -0.31955177,
            -0.31244653,
            0.7692039,
            0.16252768,
            0.1827308,
            -0.99743426,
            0.66488075,
            -0.45050567,
            0.9100398,
            0.6717471,
            -0.14665556,
            0.8417889,
            0.54149663,
            0.9168354,
            -0.3238653,
            -0.9617064,
            -0.4159156,
            0.36153734,
            0.7619178,
            0.9869877,
            0.8943422,
            -0.38498414,
            -0.082633615,
            -0.75081426,
            -0.47270322,
            0.36012292,
            -0.88456404,
            -0.07248342,
            -0.04754132,
            0.1781671,
            -0.9750448,
            0.22642684,
            -0.62839293,
            0.27920127,
            -0.23909414,
            -0.46650517,
            0.7855195,
            0.7530719,
            -0.24853009,
            0.51028,
            -0.6946726,
            0.8344754,
            -0.6782753,
            0.4649235,
            0.39905488,
            0.93086946,
            -0.16396809,
            -0.125785,
            -0.88054913,
            0.513363,
            0.21118784,
            -0.6493379,
            -0.3533305,
            0.07957065,
            0.41682458,
            0.902948,
            0.57131386,
            0.6760266,
            0.70768094,
            -0.36656404,
            -0.47016257,
            0.3245883,
            0.99321973,
            -0.8372425,
            0.016589284,
            -0.057816565,
            -0.6306389,
            -0.56279296,
            -0.9477086,
            -0.6612752,
            0.7827138,
            0.91769874,
            -0.9076654,
            -0.91042167,
            0.18699849,
            0.009961367,
            0.96068156,
            -0.6415868,
            0.6156584,
            -0.4768694,
            -0.0037181973,
            0.72644615,
            -0.5751656,
            -0.91630214,
            0.024357677,
            -0.59940094,
            -0.9091443,
            -0.13524032,
            0.4743644,
            0.9938642,
            -0.36561924,
            0.10599959,
            -0.915809,
            -0.083536744,
            0.9890624,
            0.8874723,
            0.61621284,
            0.22588706,
            -0.9462337,
            0.73690844,
            0.7834166,
            0.31176472,
            0.3830688,
            -0.31267124,
            -0.16517109,
            0.26642346,
            -0.32318473,
            0.34028876,
            -0.5041605,
            -0.90380394,
            0.8766091,
            -0.09744394,
            0.95251083,
            0.9874922,
            -0.34949875,
            -0.5481542,
            -0.23584557,
            0.03508866,
            -0.51304936,
            -0.25421256,
            -0.6483122,
            0.023252845,
            -0.685983,
            -0.25297523,
            0.48902166,
            0.9746394,
            0.54742134,
            0.28167486,
            -0.7350489,
            0.014504671,
            -0.7392747,
            -0.6564425,
            -0.73035914,
            -0.049930394,
            0.2826321,
            -0.45938128,
            -0.41234362,
            0.8615153,
            0.07010925,
            0.4365815,
            -0.8207595,
            -0.73653626,
            -0.1495806,
            -0.8317987,
            -0.1514222,
            0.27667165,
            -0.7820174,
            0.16527915,
            -0.8949183,
            -0.9971825,
            -0.78100026,
            0.71912086,
            -0.14288127,
            0.32719576,
            -0.08077842,
            0.60042965,
            0.6963247,
            0.8890984,
            0.17457163,
            -0.093120396,
            -0.57824564,
            0.4823656,
            -0.15598607,
            -0.13359714,
            0.5290332,
            -0.9653897,
            0.3359176,
            -0.59716094,
            -0.8130068,
            0.21477938,
            -0.7672006,
            -0.43579787,
            -0.0814867,
            -0.74177027,
            -0.82093155,
            0.40277302,
            0.6988081,
            -0.37628347,
            0.8164011,
            0.5717939,
            -0.6138737,
            0.50120854,
            -0.3150686,
            0.36339855,
            0.9312358,
            -0.2809558,
            0.29295075,
            -0.14147902,
            0.48693216,
            0.0076214075,
            0.27322984,
            0.17330956,
            0.107702136,
            0.3785678,
            0.7255844,
            -0.039492846,
            0.74872243,
            -0.54254484,
            0.44727635,
            0.45353937,
            -0.46220905,
            0.53520966,
            0.8476975,
            -0.13111377,
            0.6547369,
            0.60160697,
            0.47071958,
            0.74279356,
            -0.04408586,
            0.62287295,
            0.79192924,
            -0.47520995,
            -0.89499706,
            0.64616156,
            0.15956903,
            -0.39965683,
            0.8570452,
            -0.9879608,
            -0.32366484,
            -0.6583282,
            0.8096057,
            -0.9609534,
            -0.07715356,
            0.65783215,
            -0.08319044,
            0.3775916,
            -0.77092975,
            0.03761804,
            0.5895258,
            -0.8533642,
            -0.83796203,
            -0.7966925,
            -0.44205183,
            0.6414223,
            0.2841786,
            0.9866326,
            0.8531593,
            -0.43412977,
            0.543306,
            0.92294574,
            -0.88303584,
            0.495355,
            -0.36910814,
            -0.16107929,
            0.067583084,
            -0.71377206,
            -0.7739907,
            -0.54918396,
            -0.44664085,
            0.30529523,
            -0.18806195,
            -0.20475191,
            0.40623462,
            0.9612174,
            -0.81142145,
            -0.8791423,
            -0.50539005,
            -0.22170866,
            -0.2753905,
            -0.60447395,
            -0.10879171,
            0.91312456,
            0.60685575,
        ];

        for (i, v) in values.into_iter().enumerate() {
            assert_eq!(prng_one(i as u32), v);
        }
    }

    #[test]
    #[ignore]
    fn test_overflow1() {
        assert_eq!((0..u32::MAX / 1024).map(prng_one).sum::<f32>(), -204.86963);
    }

    #[test]
    #[ignore]
    fn test_overflow2() {
        assert_eq!(
            (u32::MAX / 1024..u32::MAX / 1024 * 2)
                .map(prng_one)
                .sum::<f32>(),
            -674.9333
        );
    }

    #[test]
    #[ignore]
    fn test_overflow3() {
        assert_eq!(
            (u32::MAX / 1024 * 2..u32::MAX / 1024 * 3)
                .map(prng_one)
                .sum::<f32>(),
            937.7257
        );
    }

    #[test]
    #[ignore]
    fn test_overflow4() {
        assert_eq!(
            (u32::MAX / 1024 * 3..u32::MAX / 1024 * 4)
                .map(prng_one)
                .sum::<f32>(),
            -338.02942
        );
    }

    #[test]
    #[ignore]
    fn test_overflow5() {
        assert_eq!(
            (u32::MAX / 1024 * 4..u32::MAX / 1024 * 5)
                .map(prng_one)
                .sum::<f32>(),
            -378.1073
        );
    }

    #[test]
    #[ignore]
    fn test_overflow6() {
        assert_eq!(
            (u32::MAX / 1024 * 5..u32::MAX / 1024 * 6)
                .map(prng_one)
                .sum::<f32>(),
            247.10344
        );
    }

    #[test]
    #[ignore]
    fn test_overflow7() {
        assert_eq!(
            (u32::MAX / 1024 * 6..u32::MAX / 1024 * 7)
                .map(prng_one)
                .sum::<f32>(),
            -1033.4525
        )
    }

    #[test]
    #[ignore]
    fn test_overflow8() {
        assert_eq!(
            (u32::MAX / 1024 * 7..u32::MAX / 1024 * 8)
                .map(prng_one)
                .sum::<f32>(),
            7.485667
        );
    }
}
